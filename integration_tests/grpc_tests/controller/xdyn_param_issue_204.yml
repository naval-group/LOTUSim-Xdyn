rotations convention: [psi, theta', phi'']

environmental constants:
    g: {value: 9.81, unit: m/s^2}
    rho: {value: 1026, unit: kg/m^3}
    nu: {value: 1.18e-6, unit: m^2/s}

environment models:
  - model: no waves
    constant sea elevation in NED frame: {value: 0, unit: m}

# Fixed frame: NED
bodies: # All bodies have NED as parent frame
  - name: my_fake_ship
    position of body frame relative to mesh:
        frame: mesh
        x: {value: 0, unit: m}
        y: {value: 0, unit: m}
        z: {value: 0, unit: m}
        phi: {value: 0, unit: rad}
        theta: {value: 0, unit: rad}
        psi: {value: 0, unit: rad}
    dynamics:
        hydrodynamic forces calculation point in body frame:
            x: {value: 0, unit: m}
            y: {value: 0, unit: m}
            z: {value: 3, unit: m}
        centre of inertia:
            frame: my_fake_ship
            x: {value: 0, unit: m}
            y: {value: 0, unit: m}
            z: {value: 0, unit: m}
        mass: {value: 1e4, unit: tonne} # Caution: 'ton' is the british ton which is 907.185 kg
        rigid body inertia matrix at the center of gravity and projected in the body frame:
            frame: my_fake_ship
            row 1: [1e7,0,0,0,0,0]
            row 2: [0,1e7,0,0,0,0]
            row 3: [0,0,1e7,0,0,0]
            row 4: [0,0,0,1e8,0,0]
            row 5: [0,0,0,0,1e9,0]
            row 6: [0,0,0,0,0,1e9]
        added mass matrix at the center of gravity and projected in the body frame:
            frame: my_fake_ship
            row 1: [1e7,0,0,0,0,0]
            row 2: [0,1e7,0,0,0,0]
            row 3: [0,0,1e7,0,0,0]
            row 4: [0,0,0,1e8,0,0]
            row 5: [0,0,0,0,1e9,0]
            row 6: [0,0,0,0,0,1e9]
    initial position of body frame relative to NED:
        frame: NED
        x: {value: 0, unit: m}
        y: {value: 0, unit: m}
        z: {value: 0, unit: m}
        phi: {value: 0, unit: deg}
        theta: {value: 0., unit: deg}
        psi: {value: 0, unit: deg}
    initial velocity of body frame relative to NED:
        frame: my_fake_ship
        u: {value: 3, unit: m/s}
        v: {value: 0, unit: m/s}
        w: {value: 0, unit: m/s}
        p: {value: 0, unit: rad/s}
        q: {value: 0, unit: rad/s}
        r: {value: 0, unit: rad/s}
    external forces:
    - name: PSPropRudd
      model: propeller+rudder
      position of propeller frame:
        frame: my_fake_ship
        x: {value: -50, unit: m}
        y: {value: -3, unit: m}
        z: {value: 6, unit: m}
        phi: {value: 0, unit: rad}
        theta: {value: 4., unit: deg}
        psi: {value: 0, unit: deg}
      wake coefficient w: 0.06
      relative rotative efficiency etaR: 0.99
      thrust deduction factor t: 0.18
      rotation: clockwise
      number of blades: 4
      blade area ratio AE/A0: 0.809
      diameter: {value: 3, unit: m}
      rudder area: {value: 8, unit: m^2}
      rudder height: {value: 4, unit: m}
      effective aspect ratio factor: 1.7
      lift tuning coefficient: 0.
      drag tuning coefficient: 0.
      position of rudder in body frame:
        x: {value: -50, unit: m}
        y: {value: -4, unit: m}
        z: {value: 5, unit: m}
    - name: SBPropRudd
      model: propeller+rudder
      position of propeller frame:
        frame: my_fake_ship
        x: {value: -50, unit: m}
        y: {value: +3, unit: m}
        z: {value: 6, unit: m}
        phi: {value: 0, unit: rad}
        theta: {value: 4., unit: deg}
        psi: {value: 0, unit: deg}
      wake coefficient w: 0.066
      relative rotative efficiency etaR: 0.99
      thrust deduction factor t: 0.18
      rotation: anti-clockwise
      number of blades: 4
      blade area ratio AE/A0: 0.809
      diameter: {value: 3, unit: m}
      rudder area: {value: 8, unit: m^2}
      rudder height: {value: 4, unit: m}
      effective aspect ratio factor: 1.7
      lift tuning coefficient: 0.
      drag tuning coefficient: 0.
      position of rudder in body frame:
        x: {value: -50, unit: m}
        y: {value: +4, unit: m}
        z: {value: 5, unit: m}
commands:
  - name: PSPropRudd
    t: [0, 50, 60]
    rpm: {unit: tr/s, values: [1.31, 1.31, 1.31]}
    P/D: {unit: 1, values: [1.40, 1.40, 1.40]}
  - name: SBPropRudd
    t: [0, 50, 60]
    rpm: {unit: tr/s, values: [1.31, 1.31, 1.31]}
    P/D: {unit: 1, values: [1.40, 1.40, 1.40]}
    beta: {unit: rad, values: [0.0, 0.0, 0.0]}
setpoints:
  - t: [0.0, 500.0]
    phi_co: {unit: rad, values: [0.0, 0.0]}
  - t: [0.0, 500.0]
    psi_co: {unit: rad, values: [0.0, 0.0]}
controllers:
  - type: grpc
    name: portside controller
    command: PSPropRudd(beta)
    dt: 0.5
    setpoint: psi_co
    state weights:
        x: 1
        y: -1
    gains:
        Kp: 1.
        Ki: 0.1
        Kd: 0.3
    url: python-controller:9002
